{% extends 'base.html.twig' %}
{% block title %}{{ is_login ? 'Login' : 'Signup' }} - TicketFlow{% endblock %}

{% block styles %}
<link rel="stylesheet" href="/css/auth.css" />
{% endblock %}

{% block content %}
<div class="auth-page">
  <section class="auth-hero">
    <div class="container">
      <div class="auth-card animated-fadeIn">
        <h2 class="auth-title animated-slideDown">
          {{ is_login ? 'Welcome Back' : 'Join Us Today' }}
        </h2>

        <div class="auth-toggle animated-slideUp delay-1">
          <form method="GET" action="/auth" style="display:inline;">
            <input type="hidden" name="mode" value="login">
            <button type="submit" class="toggle-btn {{ is_login ? 'active' : '' }}">Login</button>
          </form>
          <form method="GET" action="/auth" style="display:inline;">
            <input type="hidden" name="mode" value="signup">
            <button type="submit" class="toggle-btn {{ not is_login ? 'active' : '' }}">Signup</button>
          </form>
        </div>

        <form method="POST" action="/auth" class="animated-slideUp delay-2">
          <input type="hidden" name="mode" value="{{ is_login ? 'login' : 'signup' }}">

          <div class="form-group">
            <label>Email</label>
            <div class="input-wrapper">
              <input type="email" name="email" value="{{ form.email|default('') }}" required placeholder="Enter your email" />
              {% if form.email %}
                <span class="clear-icon clear-visible" onclick="this.previousElementSibling.value=''; this.classList.remove('clear-visible');">X</span>
              {% endif %}
            </div>
            {% if errors.email %}<span class="error-inline">{{ errors.email }}</span>{% endif %}
          </div>

          <div class="form-group">
            <label>Password</label>
            <div class="input-wrapper">
              <input type="password" name="password" required placeholder="Enter your password" />
              <span class="toggle-icon" onclick="togglePassword(this)" title="Toggle password">
                <svg class="eye-open" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                <svg class="eye-closed" viewBox="0 0 24 24" style="display:none;"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
              </span>
            </div>
            {% if errors.password %}<span class="error-inline">{{ errors.password }}</span>{% endif %}
          </div>

          {% if not is_login %}
            <div class="form-group">
              <label>Confirm Password</label>
              <div class="input-wrapper">
                <input type="password" name="confirm_password" required placeholder="Confirm your password" />
                <span class="toggle-icon" onclick="togglePassword(this)" title="Toggle password">
                  <svg class="eye-open" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                  <svg class="eye-closed" viewBox="0 0 24 24" style="display:none;"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                </span>
              </div>
              {% if errors.confirm_password %}<span class="error-inline">{{ errors.confirm_password }}</span>{% endif %}
            </div>
          {% endif %}

          <button type="submit" class="submit-btn animated-bounce">
            {{ is_login ? 'Login' : 'Signup' }}
          </button>
        </form>

        <p class="auth-link animated-slideUp delay-3">
          {{ is_login ? 'No account?' : 'Already have an account?' }}
          <a href="/auth?mode={{ is_login ? 'signup' : 'login' }}" class="link-btn">
            {{ is_login ? 'Signup' : 'Login' }}
          </a>
        </p>

        <p class="return-link animated-slideUp delay-4">
          Back to <a href="/">Home</a>
        </p>
      </div>

      <div class="decorative-circle animated-rotate" style="top:20%;left:10%;width:250px;height:250px;"></div>
      <div class="decorative-circle secondary-circle animated-rotate"></div>
    </div>

    <svg class="wave-background" viewBox="0 0 1440 320" preserveAspectRatio="none">
      <path fill="#0099ff" fill-opacity="0.8" d="M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,133.3C672,117,768,139,864,149.3C960,160,1056,160,1152,144C1248,128,1344,96,1392,80L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
    </svg>
  </section>

</div>

<script>
function togglePassword(btn) {
  const input = btn.previousElementSibling;
  const eyeOpen = btn.querySelector('.eye-open');
  const eyeClosed = btn.querySelector('.eye-closed');

  if (input.type === 'password') {
    input.type = 'text';
    eyeOpen.style.display = 'none';
    eyeClosed.style.display = 'block';
  } else {
    input.type = 'password';
    eyeOpen.style.display = 'block';
    eyeClosed.style.display = 'none';
  }
}
</script>
{% endblock %}